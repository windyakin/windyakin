<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>右クリックしたリンクのURLをAPIに送信するためのブラウザ拡張機能「かんかんみかん」を作りました</title>

    <meta name="description" content="windyakin&#39;s profile and portfolio site." />

    <meta property="og:title" content="右クリックしたリンクのURLをAPIに送信するためのブラウザ拡張機能「かんかんみかん」を作りました" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://windyakin.net/articles/2022/05/14/kankan-mikan.html" />
    <meta property="og:image" content="https://windyakin.net/img/ogp.png" />
    <meta property="og:description" content="windyakin&#39;s profile and portfolio site." />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@MITLicense" />
    <meta name="twitter:creator" content="@MITLicense" />
    <meta name="twitter:title" content="右クリックしたリンクのURLをAPIに送信するためのブラウザ拡張機能「かんかんみかん」を作りました" />
    <meta name="twitter:image" content="https://windyakin.net/img/ogp.png" />
    <meta name="twitter:description" content="windyakin&#39;s profile and portfolio site." />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap-grid.min.css" integrity="sha512-JQksK36WdRekVrvdxNyV3B0Q1huqbTkIQNbz1dlcFVgNynEMRl0F8OSqOGdVppLUDIvsOejhr/W5L3G/b3J+8w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css" integrity="sha512-8IZwRS36BrHutOtXP+S9ZLe/5MubhjJ26t1Kf9RYRt2kQi7brb8mLAKuJDX3qPJZ2U4Wg1cLPigCQVAxscTjtA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/open-sans-all@0.1.3/css/open-sans.min.css" integrity="sha256-wgnFwa6HsOY7SkI0IyMuzVeCe1qXdWyFp97C9tknq/U=" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="/css/base.css" />
    <link rel="stylesheet" href="/css/article.css" />
  </head>
  <body>
    <header>
      <h1><a href="/">windyakin.net</a></h1>
    </header>

    <div class="container">
  <div class="row justify-content-lg-center">
    <main class="col-12 col-lg-8 col-xl-6 order-lg-last">
      <article>
        <div class="article-header">
          <time datetime="2022-05-14">2022-05-14</time>
          <ul class="tags" aria-hidden="true">
            
            <li>
              
              <a href="/tags/つくった.html" class="tags-item">つくった</a>
            </li>
            
          </ul>
        </div>
        <h2 class="article-title">右クリックしたリンクのURLをAPIに送信するためのブラウザ拡張機能「かんかんみかん」を作りました</h2>
        <p>ブラウザでリンクを右クリックしたときに、そのリンクのURLを特定のAPIエンドポイントへPOSTデータとして送信することができるブラウザ拡張機能を作った。</p>
<ul>
<li><a href="https://chrome.google.com/webstore/detail/%E3%81%8B%E3%82%93%E3%81%8B%E3%82%93%E3%81%BF%E3%81%8B%E3%82%93/lnbmaedapefpogdjkjgliaaoglebeiil">かんかんみかん - Chrome ウェブストア</a></li>
<li><a href="https://addons.mozilla.org/ja/firefox/addon/kankan-mikan/">かんかんみかん – 🦊 Firefox (ja) 向け拡張機能を入手</a></li>
</ul>
<p>この拡張機能は、前々から筆者が Twitter の投稿のブックマークを目的として作成した Cloud Functions のエンドポイントに URL を送信するために使っていたものを、 API エンドポイントの指定や、 POST する JSON のフォーマットをテンプレートで設定できるようにすることで、一般にも利用しやすくすることで公開したものである。</p>
<p>現時点で公開している最新版 v2.0.0 で設定できる項目は以下の通り。</p>
<ul>
<li>Post URL
<ul>
<li>リクエスト送信先のURL</li>
</ul>
</li>
<li>Content-type
<ul>
<li><code>application/json</code> と <code>application/x-www-form-urlencoded</code> から選べる</li>
</ul>
</li>
<li>Post data template
<ul>
<li>送信する Body とする JSON のテンプレート</li>
<li><code>{{{ url }}}</code> が右クリックで選択しているリンクのURLに展開される</li>
</ul>
</li>
<li>Fillter (Regexp)
<ul>
<li>右クリックで選択したリンクのURLが正規表現に当てはまらなかった場合にリクエストを送信しないようにすることができる</li>
</ul>
</li>
</ul>
<p>これらの機能は、自分が使うために必要最低限の機能として実装したもので、若干高度なオプション設定が多く、作りとしても粗雑なことは否めないので、ぜひ使ってくださいとも言いづらいが、例えばブックマークサービスのAPIエンドポイントにURLを送信するとか、何らかの開発に役立てることができればと思う。</p>
<p>GitHub にスクリプトも公開してあるので、必要であれば参照してほしい。</p>
<ul>
<li><a href="https://github.com/napple-team/kankan-mikan">napple-team/kankan-mikan: 从c*・ヮ・§</a></li>
</ul>
<p>最後に愚痴になるのだが、2022年5月現在ブラウザ拡張機能を取り巻く環境は正直言って微妙で、ほんの少し前まで Chrome と Firefox で共通のプログラムで管理できていたのだが、 Chrome Web Store が Google の利益を目的として Chromium が独自に提唱している Manifest V3 という新しいフォーマットでしか新たな拡張機能の投稿を受け付けなくなってしまった。これのせいで Firefox とまた道を分かつことになってしまっており、そのために2つのブラウザの差分を吸収するように別々のスクリプトを管理することになっているので、煩わしさがすごい。</p>
<p>今回作った拡張機能はまだ Manifest V3 の変更による影響を受ける箇所は少なかったが、今後様々な拡張機能がこういった対応をしなければならないと思うと、なかなか大変そうな話だと思う。</p>

      </article>
    </main>
    <aside class="col-12 col-lg-4 col-xl-3 order-lg-first mt-5 mt-lg-0">
      <div class="profile">
  <div class="profile-image">
    <img src="/img/profile.jpg" alt="windyakin" />
  </div>

  <section>
    <h2>Profile</h2>
    <dl>
      <div>
        <dt>Name</dt>
        <dd>
          <ul class="inline-list">
            <li lang="en">KANZAKI Takuto</li><li lang="ja">神﨑 拓人</li>
          </ul>
        </dd>
      </div>
      <div>
        <dt>Screen name</dt>
        <dd>
          <ul class="inline-list">
            <li>windyakin</li><li>じゅりあん</li>
          </ul>
        </dd>
      </div>
    </dl>
  </section>

  <section>
    <h2>Organization</h2>
    <dl>
      <div>
        <dt><a href="https://pepabo.com">GMO Pepabo, Inc.</a></dt>
        <dd>Senior Engineer</dd>
      </div>
      <div>
        <dt><a href="https://napple.team/">Napple Team</a></dt>
        <dd>Organizer</dd>
      </div>
    </dl>
  </section>

  <section>
    <h2>Contact / Link</h2>
    <dl>
      <div>
        <dt>E-mail</dt>
        <dd><a href="mailto:windyakin@napple.team">windyakin@napple.team</a></dd>
      </div>
      <div>
        <dt>Twitter</dt>
        <dd><a href="https://twitter.com/MITLicense">twitter.com/MITLicense</a></dd>
      </div>
      <div>
        <dt>GitHub</dt>
        <dd><a href="https://github.com/windyakin">github.com/windyakin</a></dd>
      </div>
      <div>
        <dt>Tumblr</dt>
        <dd><a href="https://windyakin.tumblr.com/">windyakin.tumblr.com</a></dd>
      </div>
      <div>
        <dt>Facebook</dt>
        <dd><a href="https://www.facebook.com/windyakin">facebook.com/windyakin</a></dd>
      </div>
      <div>
        <dt>Vimeo</dt>
        <dd><a href="https://vimeo.com/windyakin">vimeo.com/windyakin</a></dd>
      </div>
    </dl>
  </section>
</div>

    </aside>
  </div>
</div>


    <footer>
      © 2020 windyakin
    </footer>
  </body>
</html>
